"use strict";(()=>{var e={};e.id=3707,e.ids=[3707],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},20621:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>y,originalPathname:()=>b,patchFetch:()=>S,requestAsyncStorage:()=>g,routeModule:()=>f,serverHooks:()=>x,staticGenerationAsyncStorage:()=>v,staticGenerationBailout:()=>w});var a={};t.r(a);var o={};t.r(o),t.d(o,{GET:()=>h,POST:()=>m});var n=t(95815),i=t(51150),s=t(10007),u=t(30596),d=t(71763),l=t(72225);async function c(e){let{searchParams:r}=new URL(e.url),t=r.get("dealerId")||"toyota-naples",o=r.get("location")||"Naples, FL";try{let e=new a.IntelligenceEngine,r=await e.analyze(t,o),n=(0,d.o)({chatgpt:r.aiPlatformScores?.chatgpt||28,claude:r.aiPlatformScores?.claude||31,perplexity:r.aiPlatformScores?.perplexity||22,gemini:r.aiPlatformScores?.gemini||25}),i=(0,a.estimateRevenueAtRisk)(n),s={dealerId:t,location:o,timestamp:new Date().toISOString(),metrics:{revenueAtRisk:`$${Math.round(i/1e3)}K`,aiVisibility:`${n}%`,websiteHealth:"87/100",mysteryScore:r.riskScore||73},charts:{weeklyRevenue:[{w:"W1",rev:142e3+Math.round(2e4*Math.random())},{w:"W2",rev:151e3+Math.round(2e4*Math.random())},{w:"W3",rev:137e3+Math.round(2e4*Math.random())},{w:"W4",rev:16e4+Math.round(2e4*Math.random())}],aiPlatformScores:r.aiPlatformScores},rawData:r};return u.Z.json(s)}catch(e){return console.error("Dashboard API error:",e),u.Z.json({error:"Failed to fetch dashboard data"},{status:500})}}async function p(e){try{let{dealerId:r,action:t}=await e.json();return u.Z.json({success:!0,message:`Action ${t} completed for ${r}`,timestamp:new Date().toISOString()})}catch(e){return u.Z.json({error:"Failed to process dashboard action"},{status:500})}}let h=(0,l.c2)(c),m=(0,l.c2)(p),f=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/dashboard/route",pathname:"/api/dashboard",filename:"route",bundlePath:"app/api/dashboard/route"},resolvedPagePath:"/Users/briankramer/Documents/GitHub/dealership-ai/apps/web/app/api/dashboard/route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:g,staticGenerationAsyncStorage:v,serverHooks:x,headerHooks:y,staticGenerationBailout:w}=f,b="/api/dashboard/route";function S(){return(0,s.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:v})}},72225:(e,r,t)=>{t.d(r,{c2:()=>i,do:()=>u,vG:()=>d,xq:()=>s});var a=t(30596),o=t(44955);function n(e,r={}){return async t=>{let{roles:n=[],requireDealerId:i=!1,bypassInDevelopment:s=!0}=r;try{let r=await (0,o.getToken)({req:t,secret:process.env.NEXTAUTH_SECRET});if(!r)return a.Z.json({error:"Authentication required"},{status:401});let s={id:r.sub,email:r.email,name:r.name,role:r.role,dealerId:r.dealerId};if(n.length>0&&!n.includes(s.role))return a.Z.json({error:"Insufficient permissions",required:n,current:s.role},{status:403});if(i&&!s.dealerId)return a.Z.json({error:"Dealer association required"},{status:403});return t.user=s,e(t)}catch(e){return console.error("Auth middleware error:",e),a.Z.json({error:"Authentication verification failed"},{status:500})}}}function i(e){return n(e,{roles:["admin"]})}function s(e){return n(e,{roles:["admin","dealer"],requireDealerId:!0})}function u(e,r,t){return"admin"===t||("dealer"===t||"user"===t)&&r===e}function d(e){let{searchParams:r,pathname:t}=new URL(e.url),a=r.get("dealerId");if(a)return a;let o=t.split("/"),n=o.indexOf("dealer");if(-1!==n&&o[n+1])return o[n+1]}},71763:(e,r,t)=>{function a(e){let r={chatgpt:.35,claude:.3,perplexity:.2,gemini:.15};return Math.round(e.chatgpt*r.chatgpt+e.claude*r.claude+e.perplexity*r.perplexity+e.gemini*r.gemini)}function o(e,r){return r?Math.round(e/r*100):0}t.d(r,{m:()=>o,o:()=>a})}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[1262,722,4955],()=>t(20621));module.exports=a})();