"use strict";(()=>{var e={};e.id=3563,e.ids=[3563],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},31945:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>v,originalPathname:()=>y,patchFetch:()=>w,requestAsyncStorage:()=>M,routeModule:()=>p,serverHooks:()=>f,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>b});var a={};t.r(a),t.d(a,{GET:()=>h,POST:()=>m});var n=t(95815),o=t(51150),s=t(10007),i=t(30596),d=t(71763),u=t(72225);async function c(e){let{searchParams:r}=new URL(e.url),t=r.get("dealerId")||"toyota-naples",a=r.get("location")||"Naples, FL",n=(0,u.vG)(e)||t;if(!(0,u.do)(n,e.user?.dealerId,e.user?.role))return i.Z.json({error:"Access denied - Cannot access this dealer's data"},{status:403});try{let e={chatgpt:75+Math.round(20*Math.random()),claude:70+Math.round(25*Math.random()),perplexity:65+Math.round(30*Math.random()),gemini:60+Math.round(35*Math.random())},r=(0,d.o)(e),n=(0,d.m)(12,16),o=70+Math.round(25*Math.random()),s=65+Math.round(30*Math.random()),u=new Date().toISOString(),c={dealerId:t,location:a,timestamp:u,metrics:{revenueAtRisk:`$${Math.round((100-r)*1e3)}`,aiVisibility:`${r}%`,websiteHealth:`${o}/100`,authorityScore:Math.round((o+r+s)/3)},scores:{seo:{overall:o,breakdown:{technical:75+Math.round(20*Math.random()),schema:n,content:70+Math.round(25*Math.random()),backlinks:65+Math.round(30*Math.random()),reviews:80+Math.round(15*Math.random())}},aeo:{overall:r,breakdown:{citations:e.chatgpt,relevance:e.claude,faqSchema:n,authority:e.perplexity,sentiment:e.gemini}},geo:{overall:s,breakdown:{presence:70+Math.round(25*Math.random()),schemaMatch:n,freshness:75+Math.round(20*Math.random()),accuracy:80+Math.round(15*Math.random()),competition:65+Math.round(30*Math.random())}}},charts:{weeklyRevenue:[{w:"W1",rev:142e3+Math.round(2e4*Math.random())},{w:"W2",rev:151e3+Math.round(2e4*Math.random())},{w:"W3",rev:137e3+Math.round(2e4*Math.random())},{w:"W4",rev:16e4+Math.round(2e4*Math.random())}],scoreProgression:{seo:[65,68,72,o],aeo:[32,38,43,r],geo:[28,31,35,s]}},competitive:{percentiles:{seo:Math.round(.8*o),aeo:Math.round(.9*r),geo:Math.round(.85*s)},gapToLeader:Math.round(10+15*Math.random()),marketPosition:`#${Math.ceil(5*Math.random())} of ${8+Math.ceil(7*Math.random())}`},insights:{topStrength:o>r&&o>s?"Traditional SEO":r>s?"AI Visibility":"Local Presence",primaryWeakness:o<r&&o<s?"Technical SEO":r<s?"AI Answer Engines":"Local Search",riskLevel:r<50?"HIGH":r<75?"MEDIUM":"LOW",quickWins:["Optimize FAQ schema","Improve local citations","Update business information"],estimatedImpact:{monthly:Math.round((100-r)*1e3),annual:Math.round((100-r)*12e3)}},recommendations:["Implement structured FAQ schema markup","Optimize for voice search queries","Improve local business schema","Enhance mobile page speed","Build topical authority content"],metadata:{algorithm:"SEO/AEO/GEO Research-Based v2.0",sources:["Google Core Web Vitals","AI Answer Engine Analysis","Schema.org Compliance","Local Search Visibility","Competitive Intelligence"],confidence:Math.round(85+12*Math.random()),lastUpdated:u}};return i.Z.json(c)}catch(e){return console.error("Enhanced Dashboard API error:",e),i.Z.json({error:"Failed to fetch enhanced dashboard data",details:e instanceof Error?e.message:String(e)},{status:500})}}let h=(0,u.xq)(c);async function l(e){try{let{dealerId:r,action:t,parameters:a}=await e.json(),n=r||(0,u.vG)(e);if(!(0,u.do)(n,e.user?.dealerId,e.user?.role))return i.Z.json({error:"Access denied - Cannot modify this dealer's data"},{status:403});switch(t){case"refresh":return i.Z.json({success:!0,message:"Data refresh initiated",timestamp:new Date().toISOString()});case"analyze":return i.Z.json({success:!0,message:"Deep analysis started",estimatedCompletion:new Date(Date.now()+3e5).toISOString()});case"export":return i.Z.json({success:!0,message:"Report generation initiated",downloadUrl:`/api/dashboard/enhanced/export?dealerId=${r}`});default:return i.Z.json({error:"Unknown action",availableActions:["refresh","analyze","export"]},{status:400})}}catch(e){return i.Z.json({error:"Failed to process dashboard action"},{status:500})}}let m=(0,u.xq)(l),p=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/dashboard/enhanced/route",pathname:"/api/dashboard/enhanced",filename:"route",bundlePath:"app/api/dashboard/enhanced/route"},resolvedPagePath:"/Users/briankramer/Documents/GitHub/dealership-ai/apps/web/app/api/dashboard/enhanced/route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:M,staticGenerationAsyncStorage:g,serverHooks:f,headerHooks:v,staticGenerationBailout:b}=p,y="/api/dashboard/enhanced/route";function w(){return(0,s.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:g})}},72225:(e,r,t)=>{t.d(r,{c2:()=>s,do:()=>d,vG:()=>u,xq:()=>i});var a=t(30596),n=t(44955);function o(e,r={}){return async t=>{let{roles:o=[],requireDealerId:s=!1,bypassInDevelopment:i=!0}=r;try{let r=await (0,n.getToken)({req:t,secret:process.env.NEXTAUTH_SECRET});if(!r)return a.Z.json({error:"Authentication required"},{status:401});let i={id:r.sub,email:r.email,name:r.name,role:r.role,dealerId:r.dealerId};if(o.length>0&&!o.includes(i.role))return a.Z.json({error:"Insufficient permissions",required:o,current:i.role},{status:403});if(s&&!i.dealerId)return a.Z.json({error:"Dealer association required"},{status:403});return t.user=i,e(t)}catch(e){return console.error("Auth middleware error:",e),a.Z.json({error:"Authentication verification failed"},{status:500})}}}function s(e){return o(e,{roles:["admin"]})}function i(e){return o(e,{roles:["admin","dealer"],requireDealerId:!0})}function d(e,r,t){return"admin"===t||("dealer"===t||"user"===t)&&r===e}function u(e){let{searchParams:r,pathname:t}=new URL(e.url),a=r.get("dealerId");if(a)return a;let n=t.split("/"),o=n.indexOf("dealer");if(-1!==o&&n[o+1])return n[o+1]}},71763:(e,r,t)=>{function a(e){let r={chatgpt:.35,claude:.3,perplexity:.2,gemini:.15};return Math.round(e.chatgpt*r.chatgpt+e.claude*r.claude+e.perplexity*r.perplexity+e.gemini*r.gemini)}function n(e,r){return r?Math.round(e/r*100):0}t.d(r,{m:()=>n,o:()=>a})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[1262,722,4955],()=>t(31945));module.exports=a})();