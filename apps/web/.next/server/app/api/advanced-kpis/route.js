"use strict";(()=>{var e={};e.id=6414,e.ids=[6414],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},32458:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>M,originalPathname:()=>g,patchFetch:()=>v,requestAsyncStorage:()=>p,routeModule:()=>l,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>f});var a={};r.r(a),r.d(a,{GET:()=>s});var n=r(95815),i=r(51150),o=r(10007),d=r(30596),u=r(71763);async function c(e){let{searchParams:t}=new URL(e.url),r=t.get("dealerId")||"toyota-naples";try{let e={chatgpt:72+Math.round(23*Math.random()),claude:68+Math.round(27*Math.random()),perplexity:63+Math.round(32*Math.random()),gemini:58+Math.round(37*Math.random())},t=(0,u.o)(e),a=(0,u.m)(14,18),n={dealerId:r,timestamp:new Date().toISOString(),aiVisibilityScore:t,schemaCompliance:a,revenueAtRisk:{daily:Math.round((100-t)*150),weekly:Math.round((100-t)*1050),monthly:Math.round((100-t)*4500),annual:Math.round((100-t)*54e3)},marketShare:{current:Math.round(.6*t),potential:Math.round(.9*t),gap:Math.round(.3*t)},platformPerformance:{chatgpt:{score:e.chatgpt,percentile:Math.round(.85*e.chatgpt),trend:Math.round(10*Math.random()-5)},claude:{score:e.claude,percentile:Math.round(.82*e.claude),trend:Math.round(10*Math.random()-5)},perplexity:{score:e.perplexity,percentile:Math.round(.78*e.perplexity),trend:Math.round(10*Math.random()-5)},gemini:{score:e.gemini,percentile:Math.round(.75*e.gemini),trend:Math.round(10*Math.random()-5)}},technicalHealth:{coreWebVitals:75+Math.round(20*Math.random()),mobileOptimization:68+Math.round(25*Math.random()),pageSpeed:72+Math.round(23*Math.random()),accessibility:80+Math.round(15*Math.random())},contentOptimization:{faqCoverage:a,localRelevance:70+Math.round(25*Math.random()),brandMentions:65+Math.round(30*Math.random()),reviewSentiment:78+Math.round(17*Math.random())},riskFactors:{overall:t<50?"HIGH":t<75?"MEDIUM":"LOW",technical:a<60?"HIGH":a<80?"MEDIUM":"LOW",competitive:e.chatgpt<60?"HIGH":"MEDIUM",compliance:a>85?"LOW":a>70?"MEDIUM":"HIGH"},opportunities:{quickWins:[{action:"FAQ Schema Implementation",impact:15,effort:"LOW"},{action:"Local Citations Audit",impact:12,effort:"MEDIUM"},{action:"Mobile UX Optimization",impact:18,effort:"HIGH"}],strategicInitiatives:[{action:"Voice Search Optimization",impact:25,timeline:"3-6 months"},{action:"AI-First Content Strategy",impact:30,timeline:"6-12 months"}]}};return d.Z.json(n)}catch(e){return console.error("Advanced KPIs API error:",e),d.Z.json({error:"Failed to fetch advanced KPIs"},{status:500})}}let s=(0,r(72225).c2)(c),l=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/advanced-kpis/route",pathname:"/api/advanced-kpis",filename:"route",bundlePath:"app/api/advanced-kpis/route"},resolvedPagePath:"/Users/briankramer/Documents/GitHub/dealership-ai/apps/web/app/api/advanced-kpis/route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:p,staticGenerationAsyncStorage:h,serverHooks:m,headerHooks:M,staticGenerationBailout:f}=l,g="/api/advanced-kpis/route";function v(){return(0,o.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}},72225:(e,t,r)=>{r.d(t,{c2:()=>o,do:()=>u,vG:()=>c,xq:()=>d});var a=r(30596),n=r(44955);function i(e,t={}){return async r=>{let{roles:i=[],requireDealerId:o=!1,bypassInDevelopment:d=!0}=t;try{let t=await (0,n.getToken)({req:r,secret:process.env.NEXTAUTH_SECRET});if(!t)return a.Z.json({error:"Authentication required"},{status:401});let d={id:t.sub,email:t.email,name:t.name,role:t.role,dealerId:t.dealerId};if(i.length>0&&!i.includes(d.role))return a.Z.json({error:"Insufficient permissions",required:i,current:d.role},{status:403});if(o&&!d.dealerId)return a.Z.json({error:"Dealer association required"},{status:403});return r.user=d,e(r)}catch(e){return console.error("Auth middleware error:",e),a.Z.json({error:"Authentication verification failed"},{status:500})}}}function o(e){return i(e,{roles:["admin"]})}function d(e){return i(e,{roles:["admin","dealer"],requireDealerId:!0})}function u(e,t,r){return"admin"===r||("dealer"===r||"user"===r)&&t===e}function c(e){let{searchParams:t,pathname:r}=new URL(e.url),a=t.get("dealerId");if(a)return a;let n=r.split("/"),i=n.indexOf("dealer");if(-1!==i&&n[i+1])return n[i+1]}},71763:(e,t,r)=>{function a(e){let t={chatgpt:.35,claude:.3,perplexity:.2,gemini:.15};return Math.round(e.chatgpt*t.chatgpt+e.claude*t.claude+e.perplexity*t.perplexity+e.gemini*t.gemini)}function n(e,t){return t?Math.round(e/t*100):0}r.d(t,{m:()=>n,o:()=>a})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[1262,722,4955],()=>r(32458));module.exports=a})();