"use strict";(()=>{var e={};e.id=7031,e.ids=[7031],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},31884:(e,t,a)=>{a.r(t),a.d(t,{headerHooks:()=>f,originalPathname:()=>S,patchFetch:()=>k,requestAsyncStorage:()=>g,routeModule:()=>h,serverHooks:()=>y,staticGenerationAsyncStorage:()=>v,staticGenerationBailout:()=>M});var r={};a.r(r),a.d(r,{GET:()=>u,POST:()=>p});var i=a(95815),o=a(51150),n=a(10007),s=a(30596),c=a(71763),l=a(72225);async function m(e){let{searchParams:t}=new URL(e.url),a=t.get("groupId")||"toyota-southeast",r=t.get("timeframe")||"30d";try{let e=[{dealerId:"toyota-naples",name:"Toyota Naples",location:"Naples, FL",status:"active",manager:"Sarah Chen",marketSize:"large"},{dealerId:"toyota-fort-myers",name:"Toyota Fort Myers",location:"Fort Myers, FL",status:"active",manager:"Mike Rodriguez",marketSize:"large"},{dealerId:"toyota-bonita",name:"Toyota Bonita Springs",location:"Bonita Springs, FL",status:"active",manager:"Lisa Park",marketSize:"medium"},{dealerId:"toyota-marco",name:"Toyota Marco Island",location:"Marco Island, FL",status:"active",manager:"David Kim",marketSize:"small"}],t=e.map(e=>{let t={chatgpt:70+Math.round(25*Math.random()),claude:65+Math.round(30*Math.random()),perplexity:60+Math.round(35*Math.random()),gemini:55+Math.round(40*Math.random())},a=(0,c.o)(t),r=(0,c.m)(10+Math.round(8*Math.random()),18);return{...e,metrics:{aiVisibility:a,schemaCompliance:r,revenueAtRisk:Math.round((100-a)*("large"===e.marketSize?2e3:"medium"===e.marketSize?1200:800)),monthlyRevenue:"large"===e.marketSize?85e4+Math.round(2e5*Math.random()):"medium"===e.marketSize?52e4+Math.round(15e4*Math.random()):28e4+Math.round(1e5*Math.random()),inventoryCount:"large"===e.marketSize?120+Math.round(40*Math.random()):"medium"===e.marketSize?80+Math.round(30*Math.random()):45+Math.round(20*Math.random())},performance:{voiceSearchQueries:"large"===e.marketSize?2500+Math.round(800*Math.random()):"medium"===e.marketSize?1800+Math.round(500*Math.random()):950+Math.round(300*Math.random()),radioAdEffectiveness:Math.round(75+20*Math.random()),lotOptimizationScore:Math.round(80+15*Math.random()),competitiveRanking:Math.ceil(8*Math.random())+1},platformScores:t,trends:{visibilityTrend:Math.round((Math.random()-.5)*10),revenueTrend:Math.round((Math.random()-.3)*15),lastUpdated:new Date().toISOString()}}}),i={totalLocations:e.length,activeLocations:e.filter(e=>"active"===e.status).length,totalRevenue:t.reduce((e,t)=>e+t.metrics.monthlyRevenue,0),averageVisibility:Math.round(t.reduce((e,t)=>e+t.metrics.aiVisibility,0)/e.length),totalRevenueAtRisk:t.reduce((e,t)=>e+t.metrics.revenueAtRisk,0),totalInventory:t.reduce((e,t)=>e+t.metrics.inventoryCount,0),averageSchemaCompliance:Math.round(t.reduce((e,t)=>e+t.metrics.schemaCompliance,0)/e.length)},o={topPerformer:t.reduce((e,t)=>t.metrics.aiVisibility>e.metrics.aiVisibility?t:e),bottomPerformer:t.reduce((e,t)=>t.metrics.aiVisibility<e.metrics.aiVisibility?t:e),averagePerformance:i.averageVisibility,performanceRange:{highest:Math.max(...t.map(e=>e.metrics.aiVisibility)),lowest:Math.min(...t.map(e=>e.metrics.aiVisibility))}},n=[{category:"standardization",priority:"high",title:"Standardize Schema Markup Across All Locations",impact:"Potential 8-12% visibility increase for underperforming locations",affectedLocations:t.filter(e=>e.metrics.schemaCompliance<75).length,estimatedRevenue:145e3,implementation:"Deploy unified schema template across all locations"},{category:"voice_search",priority:"medium",title:"Expand Voice Search Optimization Program",impact:"Regional voice search share increase from 34% to 42%",affectedLocations:e.length,estimatedRevenue:89e3,implementation:"Roll out voice-optimized FAQ content across franchise"},{category:"competitive",priority:"medium",title:"Unified Competitive Response Strategy",impact:"Faster response to competitor initiatives, 15% market share protection",affectedLocations:e.length,estimatedRevenue:167e3,implementation:"Implement automated competitive monitoring alerts"}],l={groupId:a,timeframe:r,timestamp:new Date().toISOString(),franchiseSummary:i,locations:t,regionalAnalysis:o,opportunities:n,marketInsights:{strongestMarkets:["Naples","Fort Myers"],emergingMarkets:["Bonita Springs"],challengingMarkets:["Marco Island"],regionalTrends:{suvDemand:"increasing_across_all_markets",hybridInterest:"highest_in_naples_fort_myers",serviceBookings:"consistent_growth_region_wide"},crossLocationOpportunities:["Share inventory between Naples and Fort Myers for optimal availability","Coordinate radio ad campaigns for regional brand consistency","Implement shared voice search strategy for Southwest Florida market"]},historicalTrends:{visibility:[82,84,86,85,87,i.averageVisibility],revenue:[21e5,218e4,224e4,219e4,228e4,i.totalRevenue],schemaCompliance:[68,72,75,73,77,i.averageSchemaCompliance]},franchiseCompetitive:{marketPosition:"regional_leader",brandRecognition:.78,serviceQualityRanking:2,digitalPresenceScore:84,overallCompetitiveScore:87}};return s.Z.json(l)}catch(e){return console.error("Multi-location API error:",e),s.Z.json({error:"Failed to fetch multi-location data"},{status:500})}}let u=(0,l.c2)(m);async function d(e){try{let{action:t,groupId:a,targetLocations:r,parameters:i}=await e.json();switch(t){case"sync_schema":return s.Z.json({success:!0,message:"Schema synchronization initiated across all locations",affectedLocations:r?.length||4,estimatedCompletion:new Date(Date.now()+18e5).toISOString(),trackingId:`schema-sync-${Date.now()}`});case"rollout_voice_optimization":return s.Z.json({success:!0,message:"Voice optimization rollout started",phases:["FAQ content deployment","Schema markup updates","Performance monitoring setup"],estimatedCompletion:new Date(Date.now()+6048e5).toISOString(),trackingId:`voice-rollout-${Date.now()}`});case"competitive_monitoring":return s.Z.json({success:!0,message:"Competitive monitoring system activated",monitoredCompetitors:["Honda Regional","Ford Southwest FL","Mazda Naples"],alertChannels:["email","dashboard","slack"],trackingId:`competitive-${Date.now()}`});default:return s.Z.json({error:"Unknown franchise action",availableActions:["sync_schema","rollout_voice_optimization","competitive_monitoring"]},{status:400})}}catch(e){return s.Z.json({error:"Failed to process franchise action"},{status:500})}}let p=(0,l.c2)(d),h=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/enterprise/multi-location/route",pathname:"/api/enterprise/multi-location",filename:"route",bundlePath:"app/api/enterprise/multi-location/route"},resolvedPagePath:"/Users/briankramer/Documents/GitHub/dealership-ai/apps/web/app/api/enterprise/multi-location/route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:g,staticGenerationAsyncStorage:v,serverHooks:y,headerHooks:f,staticGenerationBailout:M}=h,S="/api/enterprise/multi-location/route";function k(){return(0,n.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:v})}},72225:(e,t,a)=>{a.d(t,{c2:()=>n,do:()=>c,vG:()=>l,xq:()=>s});var r=a(30596),i=a(44955);function o(e,t={}){return async a=>{let{roles:o=[],requireDealerId:n=!1,bypassInDevelopment:s=!0}=t;try{let t=await (0,i.getToken)({req:a,secret:process.env.NEXTAUTH_SECRET});if(!t)return r.Z.json({error:"Authentication required"},{status:401});let s={id:t.sub,email:t.email,name:t.name,role:t.role,dealerId:t.dealerId};if(o.length>0&&!o.includes(s.role))return r.Z.json({error:"Insufficient permissions",required:o,current:s.role},{status:403});if(n&&!s.dealerId)return r.Z.json({error:"Dealer association required"},{status:403});return a.user=s,e(a)}catch(e){return console.error("Auth middleware error:",e),r.Z.json({error:"Authentication verification failed"},{status:500})}}}function n(e){return o(e,{roles:["admin"]})}function s(e){return o(e,{roles:["admin","dealer"],requireDealerId:!0})}function c(e,t,a){return"admin"===a||("dealer"===a||"user"===a)&&t===e}function l(e){let{searchParams:t,pathname:a}=new URL(e.url),r=t.get("dealerId");if(r)return r;let i=a.split("/"),o=i.indexOf("dealer");if(-1!==o&&i[o+1])return i[o+1]}},71763:(e,t,a)=>{function r(e){let t={chatgpt:.35,claude:.3,perplexity:.2,gemini:.15};return Math.round(e.chatgpt*t.chatgpt+e.claude*t.claude+e.perplexity*t.perplexity+e.gemini*t.gemini)}function i(e,t){return t?Math.round(e/t*100):0}a.d(t,{m:()=>i,o:()=>r})}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[1262,722,4955],()=>a(31884));module.exports=r})();